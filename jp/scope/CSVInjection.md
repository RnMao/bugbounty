CSV Injection
====

## 脆弱性概要
CSVインジェクションは、Webサイトが信頼できない入力をCSVファイル内に埋め込むときに発生します。Microsoft ExcelやLibreOffice Calcなどのスプレッドシートプログラムを使用してCSVを開くと、「=」で始まるすべてのセルがソフトウェアによって式(関数やマクロなど)として解釈されます。悪意を持って作成された式は、3つの主要な攻撃に使用される可能性があります。  
* スプレッドシートの脆弱性を悪用して、ユーザーのコンピューターを乗っ取る  
* ユーザーが自分のWebサイトからダウンロードしたスプレッドシートのセキュリティ警告を無視する傾向を利用して、ユーザーのコンピューターを乗っ取る  
* スプレッドシートまたは他の開いているスプレッドシートからコンテンツを引き出す  

## 脆弱性の認定可否
認定しない

## 脆弱性として認定しない理由
次の理由から、弊社ではCSV Injectionを報奨金制度の対象となる脆弱性として扱いません。  
* この脆弱性が顕在化しないようにするには、製品から出力されるCSVデータを改変する必要があります。具体的にはセル内のデータが「=」「+」「-」から始まる場合に、セルの先頭に「'」(シングルクォート)を入れることになるのですが、そうした場合、CSVの先頭をそれらの文字から始めることができません。この対策方法は、許容することはできないと判断しました。  
* Excelの仕様に関して、マイクロソフト様から次の回答をいただいています。  
> ご報告いただきました動作は、ユーザーがマクロを有効にする必要があることから、本件は脆弱性ではないと判断しております。
> 弊社が考えております脆弱性の説明およびセキュリティに関する鉄則は、以下も併せてご参照ください。  
> [「セキュリティの脆弱性」の定義](http://technet.microsoft.com/ja-jp/library/gg983510.aspx)  
> [セキュリティに関する 10 の鉄則](https://technet.microsoft.com/ja-jp/library/gg983506.aspx#E1)  

## 参考資料
脆弱性概要は、下記資料の日本語抄訳となります。  
[CSV Injection](https://owasp.org/www-community/attacks/CSV_Injection)
